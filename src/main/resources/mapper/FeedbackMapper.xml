<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.pactera.tams.module.feedback.mapper.FeedbackMapper">
	<select id="getPageList" parameterType="com.pactera.tams.module.feedback.model.Feedback" resultType="map">
		select 
			t.id,
			t.work_no,
			t.tool_name,
			t.technics_code,
			t.scheme_no,
			t.work_step,
			t.start_time,
			t.end_time,
			t.s,
			t.f,
			t.ap,
			t.fn,
			t.vc,
			t.fz,
			t.make_amount,
			t.waste_amount,
			t.recovery,
			t.qualified_amount,
			t.interrupt_reason,
			t.consume,
			t.consume_amount,
			t.sort,
			t.tenant_id,
			(select p.product_name from tams_product p where p.id=t.tool_name) as product_name,
			(select p.specification from tams_product p where p.id=t.tool_name) as product_specification,
			(select s.technics_name from tams_product_technics_scheme s where s.id=t.technics_code) as technics_name,
			(select s.code from tams_product_technics_scheme s where s.id=t.technics_code) as code
		from tams_user_feed_back t
		where 1=1
		<if test="create_by != null and create_by != ''">
			and t.create_by = '${create_by}'
		</if>
		</select>
		<select id="getBean" parameterType="com.pactera.tams.module.feedback.model.Feedback" resultType="com.pactera.tams.module.feedback.model.Feedback">
		select 
			t.id,
			t.work_no as workNo,
			t.tool_name as toolName,
			t.technics_code as technicsCode,
			t.scheme_no as schemeNo,
			t.work_step as workStep,
			t.start_time as startTime,
			t.end_time as endTime,
			t.s,
			t.f,
			t.ap,
			t.fn,
			t.vc,
			t.fz,
			t.make_amount as makeAmount,
			t.waste_amount as wasteAmount,
			t.recovery,
			t.qualified_amount as qualifiedAmount,
			t.interrupt_reason as qualifiedAmount,
			t.consume,
			t.consume_amount as consumeAmount,
			t.sort,
			t.tenant_id,
			t.tool_component as toolComponent,
			(select p.product_name from tams_product p where p.id=t.tool_name) as product_name,
			(select p.specification from tams_product p where p.id=t.tool_name) as product_specification,
			(select s.technics_name from tams_product_technics_scheme s where s.id=t.technics_code) as technics_name,
			(select s.code from tams_product_technics_scheme s where s.id=t.technics_code) as code,
			(select w.step_no from tams_product_technics_scheme_work_step w where w.id=t.scheme_no) as process_name,
			(select w.step_no from tams_product_technics_scheme_work_step w where w.id=t.work_step) as workStep_name
		from tams_user_feed_back t
		where 1=1
		<if test="id != null and id != ''">
			and t.id = '${id}'
		</if>
		</select>
</mapper>